{% extends "base.html" %}
{% from "custom_macros.html" import render_flash_alert %}
{% block head %}
<% _.forEach(htmlWebpackPlugin.files.js, function(file) { %>
<script type="text/javascript" src="<%= file%>"></script>
<%}); %>
{% endblock %}

{% block body %}
    <!-- Warning Modal -->
    <div class="modal fade" id="warningModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content alert-danger">
                <div class="modal-header">
                    <h5 class="modal-title">{{ _('Warning') }}</h5>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {{  _('You have unsaved changes in your current schedule. Continue ?') }}
                </div>
                <div class="modal-footer d-flex justify-content-between">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">{{ _('Cancel') }}</button>
                    <button type="button" class="btn btn-success" data-dismiss="modal" v-on:click="warningConfirmed">{{ _('Continue') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Course details Modal -->
    <div class="modal fade" id="courseModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{_('Course program')}}</h5>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row" v-for="(value, name) in courseInfo.summary" v-bind:key="name">
                        <h6>
                            [[ `${name}: ${courseInfo.title[name]}` ]]
                        </h6>
                        <div class="col-md" v-for="(v, n) in value">
                            <div class="card mb-3">
                                <div class="card-header">
                                    [[ n ]]
                                </div>
                                <div class="card-body">
                                    <div class="d-flex justify-content-between" v-for="id in v" v-bind:key="id" v-on:click="courseInfo.filtered[name][n][id] = !courseInfo.filtered[name][n][id]" style="cursor: pointer;">
                                        [[ id ]]
                                        <input class="form-check-input" type="checkbox" v-model="courseInfo.filtered[name][n][id]"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{{ _('Close') }}</button>
                    <button type="button" class="btn btn-success" data-dismiss="modal" v-on:click="applyFilter">{{ _('Apply') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom event Modal -->
    <div class="modal fade" id="eventModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <input class="form-control" type="text" v-model="eventInfo.title"></input>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-6">
                            <label>{{ _('Location') }}</label>
                            <textarea class="form-control" type="text" v-model="eventInfo.location"></textarea>
                        </div>

                        <div class="col-6 text-right">
                            <label>Description</label>
                            <textarea class="form-control" v-model="eventInfo.description" type="text" rows="4"></textarea>
                        </div>
                        <div v-if="eventInfo.rrule">
                            {{ _('Recurring Event !') }}
                            <p>{{ _('From') }} [[ eventInfo.pretty_startTime ]] {{ _('to') }} [[ eventInfo.pretty_endTime ]]</p>
                            <p>{{ _('Start:') }} [[ eventInfo.rrule.pretty_start ]]</p>
                            <p>{{ _('End:') }} [[ eventInfo.rrule.pretty_end ]]</p>
                            <p>{{ _('Days of week:') }} [[ eventInfo.rrule.pretty_days ]]</p>
                        </div>
                        <div v-else>
                            <p>{{ _('Start:') }} [[ eventInfo.pretty_start ]]</p>
                            <p>{{ _('End:') }} [[ eventInfo.pretty_end ]]</p>
                        </div>

                        <label>{{ _('Color') }}</label>
                        <input type="color"
                            v-bind:style="{backgroundColor: eventInfo.backgroundColor}"
                            v-model="eventInfo.backgroundColor"
                            class="swatch-custom-events ml-3"/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-dismiss="modal" v-on:click="updateEvent(eventInfo)">{{ _('Apply') }}</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{{ _('Close') }}</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal" v-on:click="removeEvent(eventInfo.event)">{{ _('Delete Event') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{_('Export')}}</h5>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {% if not current_user.is_authenticated %}
                    <h6>{{ _('Do not hesitate to create an account... you can:') }}</h6>
                    <ul class="list-group list-group-flush mb-3">
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success mr-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('Save your schedules') }}
                        </li>
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success mr-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('Manage several schedules following your needs') }}
                        </li>
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success mr-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('Modify the color of the events in the calendar') }}
                        </li>
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success mr-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('And so much more !') }}
                        </li>
                    </ul>
                    {% endif %}

                    <label class="form-label">{{_('Subscription Link')}}</label>
                    <div class="input-group">
                        <select class="form-select" style="max-width: 140px;" v-model="exportInfo.subscriptionType">
                            <option v-bind:value="0">ADE</option>
                            <option v-for="i in n_schedules" v-bind:value="i">{{ _('Schedule') }} #[[ i ]]</option>
                        </select>
                        <input type="text" class="form-control" id="input-subscription-link" v-model="subscriptionLink" readonly>
                        <button class="btn btn-outline-secondary"
                                v-on:click="copyToClipboard('input-subscription-link')"
                                data-toggle="tooltip"
                                title="{{_('Copy to clipboard')}}">
                            <svg width="20px" height="20px" viewBox="0 0 16 16" class="bi bi-clipboard-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3zM8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">
                            {{ _('You can use this link to export the schedule to your personnal calendar app (Google, iOS, etc.). This will ensure the data always stays up-to-date even through schedule changes from teachers.') }}
                        </small>
                    </div>

                    <label class="form-label">{{_('Share Link')}}</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="input-share-link" v-model="shareLink" readonly>
                        <button class="btn btn-outline-secondary"
                                v-on:click="copyToClipboard('input-share-link')"
                                data-toggle="tooltip"
                                title="{{_('Copy to clipboard')}}">
                            <svg width="20px" height="20px" viewBox="0 0 16 16" class="bi bi-clipboard-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3zM8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z"/>
                            </svg>
                        </button>
                    </div>
                    <div>
                        <small class="text-muted">
                            {{ _('You can use this link to share your schedule with your friends.') }}
                        </small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{{ _('Close') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add an event Modal -->
    <div class="modal fade" id="addEventModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <form class="modal-content needs-validation" id="form-add-event" v-on:submit.prevent="addEvent">
                <div class="modal-header">
                    <h5 class="modal-title">{{_('Add an event')}}</h5>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-6">
                            <label>{{_('Name')}}</label>
                            <input class="form-control" type="text" required v-model="eventForm.name"/>

                            <label>{{_('Location')}}</label>
                            <input class="form-control" type="text" v-model="eventForm.location"/>
                        </div>

                        <div class="col-6 text-right">
                            <label>{{_('Description')}}</label>
                            <textarea class="form-control" type="text" rows="4" v-model="eventForm.description"></textarea>
                        </div>
                    </div>

                    <!-- Repeting event ? -->
                    <div class="row mt-3">
                        <div class="col-6">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" v-model="eventForm.recurring" id="switch-repetition">
                                <label class="form-check-label" for="switch-repetition">{{_('Recurring event')}} ?</label>
                            </div>
                        </div>
                    </div>

                    <!-- Start-end inputs -->
                    <div class="row mt-3">
                        <div class="col-6">
                            <label>{{_('From')}}</label>
                            <div class="input-group date mb-2" v-show="!eventForm.recurring">
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                        <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                    </svg>
                                </div>
                                <input type="date" class="form-control text-truncate" v-model="eventForm.beginDay" v-on:blur="checkMinDay" v-bind:required="!eventForm.recurring"/>
                            </div>
                            <div class="input-group time">
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clock-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                    </svg>
                                </div>
                                <input type="time" class="form-control" v-model="eventForm.beginHour" v-on:blur="checkMinHour" required/>
                            </div>
                        </div>
                        <div class="col-6 text-right">
                            <label>{{_('To')}}</label>
                            <div class="input-group date mb-2" v-if="!eventForm.recurring">
                                <input type="date" class="form-control text-truncate" v-model="eventForm.endDay" v-on:blur="checkMaxDay" v-bind:required="!eventForm.recurring"/>
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                        <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="input-group time">
                                <input type="time" class="form-control" required v-model="eventForm.endHour" v-on:blur="checkMaxHour"/>
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clock-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recurring inputs -->
                    <div v-show="eventForm.recurring">
                        <div class="row d-flex flex-row-reverse mt-3">
                            <div class="col-6 text-right">
                                <label for="start-repetition">{{_('Days of week')}}</label>
                                <select class="form-select" multiple v-model="eventForm.freq" v-bind:required="eventForm.recurring">
                                    <option value="1">{{_('Monday')}}</option>
                                    <option value="2">{{_('Tuesday')}}</option>
                                    <option value="3">{{_('Wednesday')}}</option>
                                    <option value="4">{{_('Thursday')}}</option>
                                    <option value="5">{{_('Friday')}}</option>
                                    <option value="6">{{_('Saturday')}}</option>
                                    <option value="0">{{_('Sunday')}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-6">
                                <label>{{_('Start of recurrence')}}</label>
                                <div class="input-group date mb-2">
                                    <div class="input-group-text">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                            <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                        </svg>
                                    </div>
                                    <input type="date" class="form-control text-truncate" v-model="eventForm.beginRecurrDay" v-on:blur="checkMinRecurrDay" v-bind:required="eventForm.recurring">
                                </div>
                            </div>
                            <div class="col-6 text-right">
                                <label>{{_('End of recurrence')}}</label>
                                <div class="input-group date mb-2">
                                    <input type="date" class="form-control text-truncate" v-model="eventForm.endRecurrDay" v-on:blur="checkMaxRecurrDay" v-bind:required="eventForm.recurring">
                                    <div class="input-group-text">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                            <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{{_('Close')}}</button>
                    <button type="submit" class="btn btn-success">{{_('Add')}}</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Warning Modal -->
    <div class="modal fade" id="warningModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content alert-danger">
                <div class="modal-header">
                    <h5 class="modal-title">{{ _('Warning') }}</h5>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {{  _('The code you added does not exist in our database.') }}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">{{ _('Close') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Horizontal defiling menu -->
    <div class="nav-scroller bg-white shadow-sm">
        <nav class="nav nav-underline">
            <a class="nav-link" href="#" v-on:click="getEvents(0)" v-bind:class="{active: selected_schedule==0}">ADE</a>
            <a class="nav-link" href="#" v-on:click="getEvents(i)" v-bind:class="{active: selected_schedule==i}" v-for="i in n_schedules">{{ _('Schedule') }} #[[ i ]]</a>
            <a class="nav-link" href="#" v-on:click="getLink">{{ _('Export') }}</a>
            <a class="nav-link" href="{{ url_for('calendar.download') }}">{{_('Download')}}</a>
            <a class="nav-link" href="#" v-on:click="save">{{_('Save')}}</a>
        </nav>
    </div>

    <div class="row">
        <!-- Sidebar -->
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="sidebar-sticky p-3">
                <div class="d-flex flex-column overflow-auto">
                    {% if current_user.is_authenticated %}
                        <div class="dropdown">
                            <a class="d-flex flex-row flex-nowrap justify-content-between text-dark"
                               style="text-decoration: none"
                               data-toggle="dropdown" href="#">
                                <div class="text-truncate mr-2">
                                    <h5>[[ currentSchedule.label ]]</h5>
                                </div>
                                <svg width="23px" height="23px" viewBox="0 0 16 16" class="bi bi-chevron-down" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                                     style="min-width: 25px;">
                                    <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                                </svg>
                            </a>
                            <div class="dropdown-menu dropdown-schedules" v-if="schedules.length > 0">
                                <h6 class="dropdown-header">{{ _('Schedules') }}</h6>
                                <a class="dropdown-item text-dark text-truncate" href="#"
                                    v-for="s in schedules"
                                    v-bind:class="{active: s.id == currentSchedule.id}"
                                    v-on:click="loadSchedule($event, s.id)">
                                    [[ s.label ]]
                                </a>
                            </div>
                            <div class="dropdown-menu dropdown-schedules" v-else>
                                <h6 class="dropdown-header">{{ _('Schedules') }}</h6>
                                <a class="dropdown-item disabled text-wrap text-center">
                                    {{ _('You do not have any saved schedule at the moment') }}
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="text-truncate mr-2">
                            <h5>[[ currentSchedule.label ]]</h5>
                        </div>
                    {% endif %}
                    <a tabindex="0" href="#" class="btn-info-custom text-primary"
                       data-toggle="popover" data-trigger="focus"
                       data-content="{{ _('To view more info or adapt your schedule, click on a course code. To change the color palette, go to the account page.') }}" data-title="{{ _('Note') }}">
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                        </svg>
                    </a>
                    <div class="list-group list-code">
                        <li class="list-group-item code-item d-flex justify-content-between align-items-center"  v-for='code in codes'>
                            <div class="code-tag text-truncate" v-on:click="getDetails(code)">
                                [[ code ]]
                            </div>
                            <button class="btn btn-danger badge rounded-pill" v-on:click="removeCode(code)">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
                                </svg>
                            </button>
                        </li>
                        <li class="list-group-item p-0 list-code-input">
                            <form class="input-group my-1 dropdown" id="form-add-code" v-on:submit.prevent="addCode">
                                <input  class="form-control code-input"
                                        id="input-enter-code"
                                        autocomplete="off"
                                        type="text"
                                        placeholder="{{_('Enter code')}}"
                                        v-on:focus="codeSearchDisplay=true"
                                        v-on:blur="codeSearchDisplay=false"
                                        v-model="code" v-focus>
                                <button class="btn btn-success badge rounded-pill btn-code-validation" type="submit">+</button>
                                <ul class="dropdown-menu scrollable-menu" v-on:mousedown.prevent v-show="!(codeSearch.length==0 && code=='')">
                                    <li><h6 class="dropdown-header">{{ _('Search results') }}</h6></li>
                                    <li v-if="codeSearch.length===0">
                                        <a class="dropdown-item disabled text-center">{{ _('No results') }}</a>
                                    </li>
                                    <li><a class="dropdown-item text-truncate"
                                            v-for="result in codeSearch"
                                            v-on:click="addCode($event, result)"
                                            href="#">[[ result ]]</a>
                                    </li>
                                </ul>
                            </form>
                        </li>
                    </div>

                    <div class="mt-3">
                        <label class="form-label" for="select-project-id">{{ _('Academic year') }}</label>
                        <select class="form-select" v-model="currentProjectId" v-on:change="updateYear">
                            <option v-for="pid in projectId" v-bind:value="pid.id">
                                [[ pid.year ]]
                            </option>
                        </select>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex flex-row justify-content-between">
                            <label class="form-label mb-0" for="color-palette">{{ _('Colors') }}</label>
                            <a class="text-dark mr-2" href="#" v-on:click="resetColorPalette"
                               data-toggle="tooltip" title="{{ _('Reset colors') }}">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-counterclockwise" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
                                    <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
                                </svg>
                            </a>
                        </div>
                        <div class="d-flex flex-row flex-wrap justify-content-around" id="color-palette">
                            <div class="d-flex justify-content-center swatch-wrapper mt-2"
                                 v-for="(color, i) in currentSchedule.color_palette">
                                <input type="color" class="swatch"
                                     v-on:change="updateColor"
                                     v-bind:style="{backgroundColor: color}"
                                     v-model="currentSchedule.color_palette[i]">
                                </input>
                            </div>
                        </div>
                    </div>
                    <div class="btn-group btn-compute-clear mt-3">
                        <button class="btn btn-outline-dark btn-sm w-50" type="button" v-on:click="compute(); toggleNav(false)">
                            {{_('Compute')}}
                        </button>
                        <button class="btn btn-outline-dark btn-sm w-50" type="button" v-on:click="clear(); toggleNav(false)">
                            {{_('New') }}
                        </button>
                    </div>

                    <small class="text-center font-weight-light mt-5">
                        <a target="_blank" rel="noopener noreferrer" class="text-dark" href="https://github.com/SnaKyEyeS/ADE-Scheduler">{{_('Open source software')}}</a> {{_('designed by Gilles Poncelet, Louis Navarre and Jérome Eertmans, students at the Ecole polytechnique de Louvain.')}}
                    </small>
                </div>
            </div>
        </nav>

        <!-- Main content -->
        <div class="container-fluid">
            <div class="col-md-9 ml-sm-auto col-lg-10 p-3">
                {{ render_flash_alert() }}
                {% if saved %}<div style="display:none" id="scheduleSaved"></div>{% endif %}
                <div class="alert alert-success alert-dismissible" v-show="saveSuccess">
                    {{_('Schedule successfuly saved !')}}
                    <button type="button" class="btn-close"v-on:click="saveSuccess = false"></button>
                </div>
                <div class="alert alert-danger alert-dismissible" v-show="error">
                    {{_('A problem has occurred. Please contact us if it happens again.')}}
                    <button type="button" class="btn-close" v-on:click="error = false"></button>
                </div>
                <div class="spinner-border text-primary spinner-compute" v-show="computing"></div>
                <full-calendar ref="calendar" v-bind:options="calendarOptions" v-bind:style="calendarOpacity"></full-calendar>
                <div class="mt-4">
                    <small class="text-danger font-weight-light">
                        {{_('Disclaimer: this software is not an official UCLouvain tool. It has been designed with the purpose to help the EPL students with scheduling. This tool is based on ADE but does not replace standard scheduling rules, nor the instructions given by university officials and teachers as those may vary from one course to another.')}}
                    </small>
                </div>
            </div>
        </div>
    </div>

    <button class="btn btn-dark rounded-pill btn-nav" v-on:click="toggleNav">
        <svg v-if="navBtn" width="25px" height="25px" viewBox="0 0 16 16" class="bi bi-chevron-bar-contract" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
        </svg>
        <svg v-else width="25px" height="25px" viewBox="0 0 16 16" class="bi bi-chevron-bar-expand" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
        </svg>
    </button>
{% endblock %}
