{% extends "base.html" %}
{% block head %}
<% _.forEach(htmlWebpackPlugin.files.js, function(file) { %>
<script type="text/javascript" src="<%= file%>"></script>
<%}); %>
{% endblock %}

{% block body %}
    <!-- Warning Modal -->
    <div class="modal fade" id="warningModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content alert-danger">
                <div class="modal-header">
                    <h5 class="modal-title">{{ _('Warning') }}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {{  _('You have unsaved changes in your current schedule. Continue ?') }}
                </div>
                <div class="modal-footer d-flex justify-content-between">
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">{{ _('Cancel') }}</button>
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal" v-on:click="warningConfirmed">{{ _('Continue') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Course details Modal -->
    <div class="modal fade" id="courseModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{_('Course program')}}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex flex-row-reverse mb-3">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" v-model="selectAllToggle">
                      </div>
                      <label class="form-check-label me-2">{{ _('Select all') }}</label>
                    </div>
                    <div class="row" v-for="(value, name) in courseInfo.summary" v-bind:key="name">
                        <div class="d-flex align-items-center mb-1">
                          <div class="flex-fill">
                              [[ `${name}: ${courseInfo.title[name]}` ]]
                          </div>
                          <a v-bind:href="getCourseURL(name)" target="_blank" rel="noopener noreferrer">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-globe2 course-web-link mx-2" viewBox="0 0 16 16">
                              <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855-.143.268-.276.56-.395.872.705.157 1.472.257 2.282.287V1.077zM4.249 3.539c.142-.384.304-.744.481-1.078a6.7 6.7 0 0 1 .597-.933A7.01 7.01 0 0 0 3.051 3.05c.362.184.763.349 1.198.49zM3.509 7.5c.036-1.07.188-2.087.436-3.008a9.124 9.124 0 0 1-1.565-.667A6.964 6.964 0 0 0 1.018 7.5h2.49zm1.4-2.741a12.344 12.344 0 0 0-.4 2.741H7.5V5.091c-.91-.03-1.783-.145-2.591-.332zM8.5 5.09V7.5h2.99a12.342 12.342 0 0 0-.399-2.741c-.808.187-1.681.301-2.591.332zM4.51 8.5c.035.987.176 1.914.399 2.741A13.612 13.612 0 0 1 7.5 10.91V8.5H4.51zm3.99 0v2.409c.91.03 1.783.145 2.591.332.223-.827.364-1.754.4-2.741H8.5zm-3.282 3.696c.12.312.252.604.395.872.552 1.035 1.218 1.65 1.887 1.855V11.91c-.81.03-1.577.13-2.282.287zm.11 2.276a6.696 6.696 0 0 1-.598-.933 8.853 8.853 0 0 1-.481-1.079 8.38 8.38 0 0 0-1.198.49 7.01 7.01 0 0 0 2.276 1.522zm-1.383-2.964A13.36 13.36 0 0 1 3.508 8.5h-2.49a6.963 6.963 0 0 0 1.362 3.675c.47-.258.995-.482 1.565-.667zm6.728 2.964a7.009 7.009 0 0 0 2.275-1.521 8.376 8.376 0 0 0-1.197-.49 8.853 8.853 0 0 1-.481 1.078 6.688 6.688 0 0 1-.597.933zM8.5 11.909v3.014c.67-.204 1.335-.82 1.887-1.855.143-.268.276-.56.395-.872A12.63 12.63 0 0 0 8.5 11.91zm3.555-.401c.57.185 1.095.409 1.565.667A6.963 6.963 0 0 0 14.982 8.5h-2.49a13.36 13.36 0 0 1-.437 3.008zM14.982 7.5a6.963 6.963 0 0 0-1.362-3.675c-.47.258-.995.482-1.565.667.248.92.4 1.938.437 3.008h2.49zM11.27 2.461c.177.334.339.694.482 1.078a8.368 8.368 0 0 0 1.196-.49 7.01 7.01 0 0 0-2.275-1.52c.218.283.418.597.597.932zm-.488 1.343a7.765 7.765 0 0 0-.395-.872C9.835 1.897 9.17 1.282 8.5 1.077V4.09c.81-.03 1.577-.13 2.282-.287z"/>
                            </svg>
                          </a>
                        </div>
                        <div class="col-md" v-for="(v, n) in value">
                            <div class="card mb-3">
                                <div class="card-header">
                                    [[ n ]]
                                </div>
                                <div class="card-body">
                                    <div class="d-flex justify-content-between" v-for="id in v" v-bind:key="id" v-on:click="courseInfo.filtered[name][n][id] = !courseInfo.filtered[name][n][id]" style="cursor: pointer;">
                                        [[ id ]]
                                        <input class="form-check-input" type="checkbox" v-model="courseInfo.filtered[name][n][id]"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{ _('Close') }}</button>
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal" v-on:click="applyFilter">{{ _('Apply') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom event Modal -->
    <div class="modal fade" id="eventModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <input v-if="isEditingCustomEvent" class="form-control" type="text" v-model="eventInfo.title"/>
                    <h5 v-else class="modal-title">[[ eventInfo.title ]]</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-6">
                            <h6>{{ _('Location') }}</h6>
                            <textarea v-if="isEditingCustomEvent" class="form-control" type="text" v-model="eventInfo.location"></textarea>
                            <div v-else v-bind:class="{'text-muted': !eventInfo.location}">
                                [[ eventInfo.location ? eventInfo.location:"{{ _('No location') }}"]]
                            </div>
                        </div>
                        <div class="col-6 text-end">
                            <h6>{{ _('Description') }}</h6>
                            <textarea v-if="isEditingCustomEvent" class="form-control" type="text" v-model="eventInfo.description"></textarea>
                            <div v-else v-bind:class="{'text-muted': !eventInfo.description}">
                                [[ eventInfo.description ? eventInfo.description:"{{ _('No description') }}" ]]
                            </div>
                        </div>
                    </div>
                    <hr>

                    <div v-if="eventInfo.rrule">
                        <div class="row mb-3">
                            <div class="col-6">
                                <h6>{{ _('Start') }}</h6>
                                [[ eventInfo.rrule.pretty_start ]]
                            </div>
                            <div class="col-6 text-end">
                                <h6>{{ _('End') }}</h6>
                                [[ eventInfo.rrule.pretty_end ]]
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <h6>{{ _('Time') }}</h6>
                                [[ eventInfo.pretty_startTime ]] {{ _('to') }} [[ eventInfo.pretty_endTime ]]
                            </div>
                            <div class="col-6 text-end">
                                <h6>{{ _('Days') }}</h6>
                                [[ eventInfo.rrule.pretty_days ]]
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3" v-else>
                        <div class="col-6">
                            <h6>{{ _('Start') }}</h6>
                            [[ eventInfo.pretty_start ]]
                        </div>

                        <div class="col-6 text-end">
                            <h6>{{ _('End') }}</h6>
                            [[ eventInfo.pretty_end ]]
                        </div>
                    </div>
                    <hr>

                    <div class="row">
                        <div class="col-6">
                            <h6>{{ _('Color') }}</h6>
                        </div>
                        <div class="col-6 text-end">
                            <input type="color"
                                v-bind:style="{backgroundColor: eventInfo.backgroundColor}"
                                v-model="eventInfo.backgroundColor"
                                v-on:change="isEditingCustomEvent = true"
                                class="swatch-custom-events ms-3"/>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{ _('Close') }}</button>
                    <button type="button" class="btn"
                            v-bind:class="[[ isEditingCustomEvent ? 'btn-success':'btn-primary' ]]"
                            v-on:click="updateEditingCustomEvent">
                        [[ isEditingCustomEvent ? "{{ _('Save') }}":"{{ _('Edit') }}" ]]
                    </button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal" v-on:click="removeEvent(eventInfo.event)">{{ _('Delete') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{_('Export')}}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {% if not current_user.is_authenticated %}
                    <h6>{{ _('Do not hesitate to create an account... you can:') }}</h6>
                    <ul class="list-group list-group-flush mb-3">
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success me-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('Save your schedules') }}
                        </li>
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success me-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('Manage several schedules following your needs') }}
                        </li>
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success me-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('Modify the color of the events in the calendar') }}
                        </li>
                        <li class="list-group-item">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2-square text-success me-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                            </svg>
                            {{ _('And so much more !') }}
                        </li>
                    </ul>
                    {% endif %}

                    <label class="form-label">{{_('Subscription Link')}}</label>
                    <div class="input-group">
                        <select class="form-select" style="max-width: 140px;" v-model="exportInfo.subscriptionType">
                            <option v-bind:value="0">ADE</option>
                            <option v-for="i in n_schedules" v-bind:value="i">{{ _('Schedule') }} #[[ i ]]</option>
                        </select>
                        <input type="text" class="form-control" id="input-subscription-link" v-model="subscriptionLink" readonly>
                        <button class="btn btn-outline-secondary"
                                v-on:click="copyToClipboard('input-subscription-link')"
                                data-bs-toggle="tooltip"
                                title="{{_('Copy to clipboard')}}">
                            <svg width="20px" height="20px" viewBox="0 0 16 16" class="bi bi-clipboard-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3zM8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">
                            {{ _('You can use this link to export the schedule to your personnal calendar app (Google, iOS, etc.). This will ensure the data always stays up-to-date even through schedule changes from teachers.') }}
                        </small>
                    </div>

                    <label class="form-label">{{_('Share Link')}}</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="input-share-link" v-model="shareLink" readonly>
                        <button class="btn btn-outline-secondary"
                                v-on:click="copyToClipboard('input-share-link')"
                                data-bs-toggle="tooltip"
                                title="{{_('Copy to clipboard')}}">
                            <svg width="20px" height="20px" viewBox="0 0 16 16" class="bi bi-clipboard-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3zM8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">
                            {{ _('You can use this link to share your schedule with your friends.') }}
                        </small>
                    </div>

                    <label class="form-label">{{_('Download to iCalendar format')}}</label>
                    <div class="input-group">
                        <select class="form-select" style="max-width: 140px;" v-model="exportInfo.downloadType">
                            <option v-bind:value="0">ADE</option>
                            <option v-for="j in n_schedules" v-bind:value="j">{{ _('Schedule') }} #[[ j ]]</option>
                        </select>
                        <button class="btn btn-outline-secondary"
                                v-on:click="downloadCalendar()"
                                data-bs-toggle="tooltip"
                                title="{{_('Download')}}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                            </svg>
                        </button>
                    </div>
                    <div>
                        <small class="text-muted">
                            {{ _('You can use this file and upload it to your favorite calendar app. Nonetheless, events will not be updated if any change occur on ADE.') }}
                        </small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{ _('Close') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add an event Modal -->
    <div class="modal fade" id="addEventModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <form class="modal-content needs-validation" id="form-add-event" v-on:submit.prevent="addEvent">
                <div class="modal-header">
                    <h5 class="modal-title">{{_('Add an event')}}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-6">
                            <label>{{_('Name')}}</label>
                            <input class="form-control" type="text" required v-model="eventForm.name"/>

                            <label>{{_('Location')}}</label>
                            <input class="form-control" type="text" v-model="eventForm.location"/>
                        </div>

                        <div class="col-6 text-end">
                            <label>{{_('Description')}}</label>
                            <textarea class="form-control" type="text" rows="4" v-model="eventForm.description"></textarea>
                        </div>
                    </div>

                    <!-- Repeting event ? -->
                    <div class="row mt-3">
                        <div class="col-6">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" v-model="eventForm.recurring" id="switch-repetition">
                                <label class="form-check-label" for="switch-repetition">{{_('Recurring event')}} ?</label>
                            </div>
                        </div>
                    </div>

                    <!-- Start-end inputs -->
                    <div class="row mt-3">
                        <div class="col-6">
                            <label>{{_('From')}}</label>
                            <div class="input-group date mb-2" v-show="!eventForm.recurring">
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                        <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                    </svg>
                                </div>
                                <input type="date" class="form-control text-truncate" v-model="eventForm.beginDay" v-on:blur="checkMinDay" v-bind:required="!eventForm.recurring"/>
                            </div>
                            <div class="input-group time">
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clock-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                    </svg>
                                </div>
                                <input type="time" class="form-control" v-model="eventForm.beginHour" v-on:blur="checkMinHour" required/>
                            </div>
                        </div>
                        <div class="col-6 text-end">
                            <label>{{_('To')}}</label>
                            <div class="input-group date mb-2" v-if="!eventForm.recurring">
                                <input type="date" class="form-control text-truncate" v-model="eventForm.endDay" v-on:blur="checkMaxDay" v-bind:required="!eventForm.recurring"/>
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                        <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="input-group time">
                                <input type="time" class="form-control" required v-model="eventForm.endHour" v-on:blur="checkMaxHour"/>
                                <div class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clock-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recurring inputs -->
                    <div v-show="eventForm.recurring">
                        <div class="row d-flex flex-row-reverse mt-3">
                            <div class="col-6 text-end">
                                <label for="start-repetition">{{_('Days of week')}}</label>
                                <select class="form-select" multiple v-model="eventForm.freq" v-bind:required="eventForm.recurring">
                                    <option value="1">{{_('Monday')}}</option>
                                    <option value="2">{{_('Tuesday')}}</option>
                                    <option value="3">{{_('Wednesday')}}</option>
                                    <option value="4">{{_('Thursday')}}</option>
                                    <option value="5">{{_('Friday')}}</option>
                                    <option value="6">{{_('Saturday')}}</option>
                                    <option value="0">{{_('Sunday')}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-6">
                                <label>{{_('Start of recurrence')}}</label>
                                <div class="input-group date mb-2">
                                    <div class="input-group-text">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                            <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                        </svg>
                                    </div>
                                    <input type="date" class="form-control text-truncate" v-model="eventForm.beginRecurrDay" v-on:blur="checkMinRecurrDay" v-bind:required="eventForm.recurring">
                                </div>
                            </div>
                            <div class="col-6 text-end">
                                <label>{{_('End of recurrence')}}</label>
                                <div class="input-group date mb-2">
                                    <input type="date" class="form-control text-truncate" v-model="eventForm.endRecurrDay" v-on:blur="checkMaxRecurrDay" v-bind:required="eventForm.recurring">
                                    <div class="input-group-text">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-calendar-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
                                            <path d="M2 1a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2H2zm14 4H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5z"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{_('Close')}}</button>
                    <button type="submit" class="btn btn-success">{{_('Add')}}</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Warning Modal -->
    <div class="modal fade" id="warningModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content alert-danger">
                <div class="modal-header">
                    <h5 class="modal-title">{{ _('Warning') }}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    {{  _('The code you added does not exist in our database.') }}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">{{ _('Close') }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Horizontal defiling menu -->
    <div class="nav-scroller bg-white shadow-sm">
        <nav class="nav nav-underline">
            <a class="nav-link active" href="#"
                v-on:click="getEvents(0)"
                v-if="selected_schedule==0">
                ADE
            </a>
            <a class="nav-link active" href="#"
                v-on:click="getEvents(selected_schedule)"
                v-else>
                {{ _('Schedule') }} #[[ selected_schedule ]]
            </a>
            <a class="d-flex align-items-center schedule-toggle"
               v-on:click="toggleBestSchedules()"
               v-if="n_schedules > 0"
               data-bs-toggle="tooltip"
               title="{{_('Show/Hide')}}">
                <svg xmlns="http://www.w3.org/2000/svg" v-if="!show_best_schedules" width="16" height="16" fill="currentColor" class="bi bi-caret-right" viewBox="0 0 16 16">
                    <path d="M6 12.796V3.204L11.481 8 6 12.796zm.659.753l5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753z"/>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" v-else width="16" height="16" fill="currentColor" class="bi bi-caret-left" viewBox="0 0 16 16">
                    <path d="M10 12.796V3.204L4.519 8 10 12.796zm-.659.753l-5.48-4.796a1 1 0 0 1 0-1.506l5.48-4.796A1 1 0 0 1 11 3.204v9.592a1 1 0 0 1-1.659.753z"/>
                </svg>
            </a>
            <a class="nav-link" href="#"
                v-show="show_best_schedules & selected_schedule!=0"
                v-on:click="getEvents(0)"
                v-bind:class="{active: selected_schedule==0}">
                ADE
            </a>
            <a class="nav-link" href="#"
                v-show="show_best_schedules & selected_schedule!=i"
                v-on:click="getEvents(i)"
                v-bind:class="{active: selected_schedule==i}"
                v-for="i in n_schedules">
                {{ _('Schedule') }} #[[ i ]]
            </a>
            <a class="d-flex align-items-center schedule-toggle"
               v-if="show_best_schedules"
               v-on:click="resetBestSchedules()"
               data-bs-toggle="tooltip"
               title="{{_('Delete best schedules')}}">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
            </a>
            <!-- <a class="nav-link" href="#" v-if="show_best_schedules" v-on:click="getEvents(i)" v-bind:class="{active: selected_schedule==i}" v-for="i in n_schedules">{{ _('Schedule') }} #[[ i ]]</a> -->
            <a class="nav-link" href="#" v-on:click="getLink">{{ _('Export') }}</a>
            <a class="nav-link" href="#" v-on:click="save">{{_('Save')}}</a>
        </nav>
    </div>

    <div class="row">
        <!-- Sidebar -->
        <sidebar-menu ref="sidebar">
          <div class="d-flex flex-column overflow-auto" style="margin-top: 45px;">
              {% if current_user.is_authenticated %}
                  <div class="dropdown">
                      <a class="d-flex flex-row flex-nowrap justify-content-between text-dark"
                         style="text-decoration: none"
                         data-bs-toggle="dropdown" href="#">
                          <div class="text-truncate me-2">
                              <h5>[[ currentSchedule.label ]]</h5>
                          </div>
                          <svg width="23px" height="23px" viewBox="0 0 16 16" class="bi bi-chevron-down" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                               style="min-width: 25px;">
                              <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                          </svg>
                      </a>
                      <div class="dropdown-menu dropdown-schedules" v-if="schedules.length > 0">
                          <h6 class="dropdown-header">{{ _('Schedules') }}</h6>
                          <a class="dropdown-item text-dark text-truncate" href="#"
                              v-for="s in schedules"
                              v-bind:class="{active: s.id == currentSchedule.id}"
                              v-on:click="loadSchedule($event, s.id)">
                              [[ s.label ]]
                          </a>
                      </div>
                      <div class="dropdown-menu dropdown-schedules" v-else>
                          <h6 class="dropdown-header">{{ _('Schedules') }}</h6>
                          <a class="dropdown-item disabled text-wrap text-center">
                              {{ _('You do not have any saved schedule at the moment') }}
                          </a>
                      </div>
                  </div>
              {% else %}
                  <div class="text-truncate me-2">
                      <h5>[[ currentSchedule.label ]]</h5>
                  </div>
              {% endif %}
              <a tabindex="0" href="#" class="btn-info-custom text-primary"
                 data-bs-toggle="popover" data-bs-trigger="focus"
                 data-bs-content="{{ _('To view more info or adapt your schedule, click on a course code. To change the color palette, go to the account page.') }}" data-bs-title="{{ _('Note') }}">
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-info-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                  </svg>
              </a>
              <div class="list-group list-code">
                  <li class="list-group-item code-item d-flex justify-content-between align-items-center"  v-for='code in codes'>
                      <div class="code-tag text-truncate" v-on:click="getDetails(code)">
                          [[ code ]]
                      </div>
                      <button class="btn btn-danger badge rounded-pill" v-on:click="removeCode(code)">
                          <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
                          </svg>
                      </button>
                  </li>
                  <li class="list-group-item p-0 list-code-input">
                      <form class="input-group my-1 dropdown" id="form-add-code" v-on:submit.prevent="addCode">
                          <div id="codeInputDropdown" data-bs-toggle="dropdown" data-bs-auto-close="false"></div>
                          <input  class="form-control code-input"
                                  autocomplete="off"
                                  type="text"
                                  placeholder="{{_('Enter code')}}"
                                  v-on:focus="codeSearchDisplay=true"
                                  v-on:blur="codeSearchDisplay=false"
                                  v-model="code" v-focus>
                          <button class="btn btn-success badge rounded-pill" type="submit">+</button>
                          <ul class="dropdown-menu scrollable-menu" v-on:mousedown.prevent v-show="!(codeSearch.length==0 && code=='')">
                              <li><h6 class="dropdown-header">{{ _('Search results') }}</h6></li>
                              <li v-if="codeSearch.length===0">
                                  <a class="dropdown-item disabled text-center">{{ _('No results') }}</a>
                              </li>
                              <li><a class="dropdown-item text-truncate"
                                      v-for="result in codeSearch"
                                      v-on:click="addCode($event, result)"
                                      href="#">[[ result ]]</a>
                              </li>
                          </ul>
                      </form>
                  </li>
              </div>

              <div class="mt-3">
                  <label class="form-label" for="select-project-id">{{ _('Academic year') }}</label>
                  <select class="form-select" v-model="currentProjectId" v-on:change="updateYear">
                      <option v-for="pid in projectId" v-bind:value="pid.id">
                          [[ pid.year ]]
                      </option>
                  </select>
              </div>
              <div class="mt-3">
                  <div class="d-flex flex-row justify-content-between">
                      <label class="form-label mb-0" for="color-palette">{{ _('Colors') }}</label>
                      <a class="text-dark me-2" href="#" v-on:click="resetColorPalette"
                         data-bs-toggle="tooltip" title="{{ _('Reset colors') }}">
                          <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-counterclockwise" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
                              <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
                          </svg>
                      </a>
                  </div>
                  <div class="d-flex flex-row flex-wrap justify-content-around" id="color-palette">
                      <div class="d-flex justify-content-center swatch-wrapper mt-2"
                           v-for="(color, i) in currentSchedule.color_palette">
                          <input type="color" class="swatch"
                               v-on:change="updateColor"
                               v-bind:style="{backgroundColor: color}"
                               v-model="currentSchedule.color_palette[i]">
                          </input>
                      </div>
                  </div>
              </div>
              <div class="btn-group btn-compute-clear mt-3">
                  <button class="btn btn-outline-dark btn-sm w-50"
                      type="button"
                      data-bs-toggle="tooltip"
                      title="{{_('Compute the best schedules with no conflict!\nSee help page for more details on how it works')}}"
                      v-on:click="compute(); closeSidebar()">
                      {{_('Compute')}}
                  </button>
                  <button class="btn btn-outline-dark btn-sm w-50"
                      type="button"
                      data-bs-toggle="tooltip"
                      title="{{_('Start a new schedule from zero\nYou can have multiple schedules with an account')}}"
                      v-on:click="clear(); closeSidebar()">
                      {{_('New') }}
                  </button>
              </div>

              <small class="text-center font-weight-light mt-5">
                  <a target="_blank" rel="noopener noreferrer" class="text-dark" href="https://github.com/SnaKyEyeS/ADE-Scheduler">{{_('Open source software')}}</a> {{_('designed by Gilles Poncelet, Louis Navarre and JÃ©rome Eertmans, students at the Ecole polytechnique de Louvain.')}}
              </small>
          </div>
        </sidebar-menu>

        <!-- Main content -->
        <div class="container-fluid">
            <div class="col-md-9 ms-sm-auto col-lg-10 p-3">
                <spinner v-bind:computing="computing">
                  <full-calendar ref="calendar" v-bind:options="calendarOptions"></full-calendar>
                </spinner>
                <div class="mt-4">
                    <small class="text-danger font-weight-light">
                        {{_('Disclaimer: ADE Scheduler is not an official UCLouvain tool. It has been designed with the purpose to help the UCLouvain students with scheduling. This tool is based on ADE UCL but does not replace standard scheduling rules, nor the instructions given by university officials and teachers as those may vary from one course to another.')}}
                    </small>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
