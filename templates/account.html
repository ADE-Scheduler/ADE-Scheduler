{% extends "base.html" %}
{% block head %}
<% _.forEach(htmlWebpackPlugin.files.js, function(file) { %>
<script type="text/javascript" src="<%= file%>"></script>
<%}); %>
{% endblock %}

{% block body %}
<!-- Course details Modal -->
<div class="modal fade" id="warningModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content alert-danger">
            <div class="modal-header">
                <h5 class="modal-title">{{ _('Warning') }}</h5>
                <button type="button" class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                {{  _('You have unsaved changes in your current schedule. Continue ?') }}
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-danger" data-dismiss="modal">{{ _('Cancel') }}</button>
                <button type="button" class="btn btn-success" data-dismiss="modal" v-on:click="warningContinue">{{ _('Continue') }}</button>
            </div>
        </div>
    </div>
</div>


<div class="container-lg">
    <div class="row">
        <div class="col-md-8 col-lg-9 p-3">
            <div class="alert alert-danger alert-dismissible" v-show="error">
                {{  _('A problem has occurred. Please contact us if it happens again.') }}
                <button type="button" class="close" v-on:click="error = false">
                    <span>&times;</span>
                </button>
            </div>
            <div class="card">
                <div class="spinner-border text-primary spinner-compute" v-show="computing"></div>
                <div class="card-header d-flex justify-content-between align-items-center" id="form-update-label" v-bind:style="opacity">
                    <input class="form-control mr-4" type="text" v-focus v-model="current_schedule.label" v-if="isEditing" v-on:keyup.enter="updateLabel($event, current_schedule.id)" v-on:blur="isEditing = false" v-on:keyup.esc="isEditing = false"/>
                    <div id="schedule-label" v-else v-on:click="isEditing = true">
                        [[ current_schedule.label ]]
                    </div>
                    <a class="text-dark" href="#" v-on:click="updateLabel($event, current_schedule.id)">
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-pencil" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M11.293 1.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1 0 1.414l-9 9a1 1 0 0 1-.39.242l-3 1a1 1 0 0 1-1.266-1.265l1-3a1 1 0 0 1 .242-.391l9-9zM12 2l2 2-9 9-3 1 1-3 9-9z"/>
                            <path fill-rule="evenodd" d="M12.146 6.354l-2.5-2.5.708-.708 2.5 2.5-.707.708zM3 10v.5a.5.5 0 0 0 .5.5H4v.5a.5.5 0 0 0 .5.5H5v.5a.5.5 0 0 0 .5.5H6v-1.5a.5.5 0 0 0-.5-.5H5v-.5a.5.5 0 0 0-.5-.5H3z"/>
                        </svg>
                    </a>
                </div>
                <div class="card-body" v-bind:style="opacity">
                    <label class="form-label" for="color-palette">{{ _('Color palette') }}</label>
                    <div class="d-flex flex-row flex-wrap justify-content-around mb-3" id="color-palette">
                        <v-swatches class="mx-1" show-fallback fallback-input-type="color" v-for="(color, i) in current_schedule.color_palette" v-model="current_schedule.color_palette[i]"></v-swatches>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="select-project-id">{{ _('Academic year') }}</label>
                        <select class="form-select" style="max-width: 180px;" v-model="current_schedule.project_id" id="select-project-id">
                            <option v-for="pid in projectId" v-bind:value="pid.id">
                                [[ pid.year ]]
                            </option>
                        </select>
                    </div>
                    <div class="btn-group d-flex">
                        <button class="btn btn-dark" v-on:click="save">{{ _('Save') }}</button>
                        <button class="btn btn-warning" v-on:click="viewSchedule($event, current_schedule.id)">{{ _('View') }}</button>
                        <button class="btn btn-danger" v-on:click="deleteSchedule($event, current_schedule.id)">{{  _('Delete') }}</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 col-lg-3 p-3">
            <h4 class="d-flex justify-content-between align-items-center">
                <span class="text-muted">{{ _('Schedules') }}</span>
            </h4>
            <ul class="list-group list-schedules">
                <li class="list-group-item d-flex justify-content-between align-items-center" v-for="s in schedules" v-bind:key="s.id" v-bind:class="s.id === current_schedule.id ? 'current-schedule' : ''">
                    <h6 class="text-truncate my-0" v-on:click="loadSchedule($event, s.id)">
                        [[ s.label ]]
                    </h6>
                    <div class="d-flex flex-nowrap">
                        <a class="text-secondary mx-2" href="#" v-on:click="viewSchedule($event, s.id)">
                            <svg width="1.3em" height="1.3em" viewBox="0 0 16 16" class="bi bi-eye-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
                                <path fill-rule="evenodd" d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
                            </svg>
                        </a>
                        <a class="text-danger" href="#" v-on:click="deleteSchedule($event, s.id)">
                            <svg width="1.3em" height="1.3em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/>
                                <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/>
                            </svg>
                        </a>
                    </div>
                </li>
            </ul>

            <div class="mt-4 text-center">
                <small class="font-weight-light">
                    <a class="text-dark" href="https://github.com/SnaKyEyeS/ADE-Scheduler">{{_('OpenSource software')}}</a> {{_('designed by Gilles Poncelet, Louis Navarre and JÃ©rome Eertmans, students at the Ecole Polytechnique de Louvain.')}}
                </small>
            </div>
        </div>
    </div>
</div>
{% endblock %}
